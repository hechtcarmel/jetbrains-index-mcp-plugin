<!-- Plugin Configuration File. Read more: https://plugins.jetbrains.com/docs/intellij/plugin-configuration-file.html -->
<idea-plugin>
    <id>com.github.hechtcarmel.jetbrainsindexmcpplugin</id>
    <name>IntelliJ Index MCP Server</name>
    <vendor email="hechtcarmel@gmail.com" url="https://github.com/hechtcarmel">hechtcarmel</vendor>
    <description><![CDATA[
<h2>IntelliJ Index MCP Server</h2>

<p>Expose your IDE's powerful indexing and refactoring capabilities to AI coding assistants via the
<a href="https://modelcontextprotocol.io">Model Context Protocol (MCP)</a>.</p>

<h3>ðŸš€ Features</h3>

<h4>Navigation Tools</h4>
<ul>
    <li><b>Find References</b> - Locate all usages of any symbol across your project</li>
    <li><b>Go to Definition</b> - Navigate to symbol declarations</li>
    <li><b>Type Hierarchy</b> - Explore class and interface inheritance</li>
    <li><b>Call Hierarchy</b> - Trace method call chains</li>
    <li><b>Find Implementations</b> - Discover interface and abstract class implementations</li>
</ul>

<h4>Refactoring Tools</h4>
<ul>
    <li><b>Rename</b> - Safely rename symbols across the entire project</li>
    <li><b>Extract Method</b> - Extract code blocks into new methods</li>
    <li><b>Extract Variable</b> - Extract expressions into variables</li>
    <li><b>Inline</b> - Inline variables and methods</li>
    <li><b>Safe Delete</b> - Remove unused code safely</li>
    <li><b>Move</b> - Move elements between files</li>
</ul>

<h4>Code Intelligence</h4>
<ul>
    <li><b>Code Completions</b> - Get intelligent completion suggestions</li>
    <li><b>Code Analysis</b> - Run inspections and detect issues</li>
    <li><b>Quick Fixes</b> - List and apply available fixes</li>
    <li><b>Symbol Info</b> - Get documentation and type information</li>
</ul>

<h4>Project Insights</h4>
<ul>
    <li><b>Project Structure</b> - Query module and source root layout</li>
    <li><b>File Structure</b> - Get class, method, and field outlines</li>
    <li><b>Dependencies</b> - List project libraries and versions</li>
    <li><b>Index Status</b> - Check if IDE indexing is complete</li>
</ul>

<h3>ðŸ¤– Supported AI Assistants</h3>
<ul>
    <li>Claude Desktop</li>
    <li>Claude Code (CLI)</li>
    <li>Cursor</li>
    <li>VS Code with MCP extension</li>
    <li>Windsurf</li>
    <li>Any MCP-compatible client</li>
</ul>

<h3>âš¡ Quick Start</h3>
<ol>
    <li>Install the plugin and restart the IDE</li>
    <li>Open the <b>Index MCP Server</b> tool window (View â†’ Tool Windows)</li>
    <li>Click <b>Copy Config</b> and select your AI assistant</li>
    <li>Paste the configuration into your assistant's MCP settings</li>
    <li>Start using IDE-powered tools in your AI assistant!</li>
</ol>

<h3>ðŸ”§ How It Works</h3>
<p>The plugin runs an MCP server on your IDE's built-in web server, exposing tools that leverage
IntelliJ's semantic understanding of your code. AI assistants connect via HTTP+SSE transport and
can invoke any of the 20 available tools to perform accurate refactoring, navigation, and code analysis.</p>

<h3>ðŸ“š Documentation</h3>
<p>See the <a href="https://github.com/hechtcarmel/jetbrains-index-mcp-plugin">GitHub repository</a>
for detailed documentation, examples, and troubleshooting guides.</p>

<h3>ðŸ”’ Privacy</h3>
<p>All processing happens locally within your IDE. No code is sent to external servers by this plugin.</p>
]]></description>

    <!-- Platform dependency (required) -->
    <depends>com.intellij.modules.platform</depends>

    <!-- Optional Java support -->
    <depends optional="true" config-file="java-features.xml">com.intellij.modules.java</depends>

    <!-- Optional Kotlin support -->
    <depends optional="true" config-file="kotlin-features.xml">org.jetbrains.kotlin</depends>

    <resource-bundle>messages.McpBundle</resource-bundle>

    <extensions defaultExtensionNs="com.intellij">
        <!-- Application-level MCP Server Service -->
        <applicationService
            serviceImplementation="com.github.hechtcarmel.jetbrainsindexmcpplugin.server.McpServerService"/>

        <!-- Project-level Command History Service -->
        <projectService
            serviceImplementation="com.github.hechtcarmel.jetbrainsindexmcpplugin.history.CommandHistoryService"/>

        <!-- HTTP Request Handler for /index-mcp endpoint -->
        <httpRequestHandler
            implementation="com.github.hechtcarmel.jetbrainsindexmcpplugin.server.McpRequestHandler"/>

        <!-- Tool Window -->
        <toolWindow
            id="Index MCP Server"
            anchor="bottom"
            icon="com.github.hechtcarmel.jetbrainsindexmcpplugin.icons.McpIcons.ToolWindow"
            factoryClass="com.github.hechtcarmel.jetbrainsindexmcpplugin.ui.McpToolWindowFactory"/>

        <!-- Settings -->
        <applicationService
            serviceImplementation="com.github.hechtcarmel.jetbrainsindexmcpplugin.settings.McpSettings"/>
        <applicationConfigurable
            id="mcp.settings"
            displayName="Index MCP Server"
            instance="com.github.hechtcarmel.jetbrainsindexmcpplugin.settings.McpSettingsConfigurable"/>

        <!-- Startup Activity -->
        <postStartupActivity
            implementation="com.github.hechtcarmel.jetbrainsindexmcpplugin.startup.McpServerStartupActivity"/>

        <!-- Notification Group -->
        <notificationGroup
            id="Index MCP Server"
            displayType="BALLOON"/>
    </extensions>

    <!-- Extension Point for Custom Tools -->
    <extensionPoints>
        <extensionPoint
            name="mcpTool"
            interface="com.github.hechtcarmel.jetbrainsindexmcpplugin.tools.McpTool"
            dynamic="true"/>
    </extensionPoints>

    <actions>
        <group id="McpServer.Actions" text="Index MCP Server">
            <action id="McpServer.CopyUrl"
                class="com.github.hechtcarmel.jetbrainsindexmcpplugin.actions.CopyServerUrlAction"
                text="Copy Server URL"
                description="Copy the MCP server URL to clipboard"/>
            <action id="McpServer.CopyConfig"
                class="com.github.hechtcarmel.jetbrainsindexmcpplugin.actions.CopyClientConfigAction"
                text="Copy Client Config..."
                description="Copy MCP client configuration for AI assistants"/>
            <action id="McpServer.ClearHistory"
                class="com.github.hechtcarmel.jetbrainsindexmcpplugin.actions.ClearHistoryAction"
                text="Clear History"
                description="Clear command history"/>
            <action id="McpServer.ExportHistory"
                class="com.github.hechtcarmel.jetbrainsindexmcpplugin.actions.ExportHistoryAction"
                text="Export History..."
                description="Export command history to file"/>
        </group>
    </actions>
</idea-plugin>
